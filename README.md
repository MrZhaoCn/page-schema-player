# 配页坊 - 为配置页面而生, 简称配方

基于 [amis-admin](https://github.com/fex-team/amis-admin) 提供以配置的方式快速搭建(后台)页面的能力, 释放前端人力, 提升整体人效

名字灵感来源: [《长安十二时辰》, 长安一百零八坊](https://baike.baidu.com/tashuo/browse/content?id=7a42871d4821ddfd79e93fa8)

> 坊，先秦开始称“里”“闾”“闾里”，是中国古代城市居住区组织的基本单位，南北朝开始出现“坊”的称呼，隋朝开始正式改称“坊”，唐代里、坊称呼互相使用，长安城以坊为基本单位的格局称为“里坊制”。

## 为什么发起这个项目?

* 因为后台系统实在太多了, 而且都大同小异, 消耗了大量的前端人力
* **在前后端分离的大趋势下, 前端和后端技术栈日益差异化并逐渐形成一些技术壁垒**
* 随着前端参与到越来越多的后台系统开发中去, 逐渐将越来越多的后台系统升级改造为前后端分离的开发模式
* 对于前端来说, 活是越来越多, 但总会有些枯燥无味(让你天天开发后台系统试一试), 因为后台系统差不多都是列表和表单
* **对于人效来说, 由于前后端分离带来的人力资源短板, 在某些时候反而降低了效率**
* 因为由于前端技术近几年的快速发展, 前端技术栈已经大不一样了, 不再是以往简单的"所见即所得的开发模式"
* 前端技术栈越来越与后端方向靠齐, 什么模块化, 组件, 依赖, 包, 转义, 构建, 上线等等相似的概念孕育而生
* 更有很多前端特有的"黑话", 例如兼容性, npm 包, npm 源, babel, ES5, ES2015 等等, 更别提前端那些数不胜数的框架了, 什么单页项目走起, 全家桶来一波
* 前后端分离之后, 前端将页面的开发模式做了一场翻天覆地的大升级, 对前端来说是越来越有利于项目的迭代
* **但对于后端开发人员来说, 面对前端新的技术栈, 看到的可能更多是学习的成本**
* 这样造成的局面就是: **可能简单到只是修改页面上的一个文字, 都需要前端同学的参与**
* 回想以前不分离的时候, 很多页面上简单的活, 后端同学自己分分钟就搞定上线了
* 这也就是前后端分离之后, 我们必须面对的一个问题, 以前前端和后端都能做的事情, 现在只有前端能做了
* 前后端分离之后, 前端和后端的专业化势必带来价值, 将后端从页面的苦海中解脱了出来, 用户的体验也会越来越好
* 但随着前端参与的项目越来越多, 前端疲于奔命的情况也将越来越多, 总是各种项目并行, 各种缺前端人员
* **前端人员有限, 现在页面上什么活都等着前端来做, 其他人员看着干瞪眼的情况, 总是需要想办法解决的**

## 如何解决前端人力短板的问题?

* 核心就一个词: **前端赋能**, 即将前端能力服务化
* 首先需要知道前端有哪些能力, 哪些能力可以服务化, 哪些能力服务化之后最有价值
* 综合之下, 个人认为前端最核心能力要数**搭页面的能力**了, 此乃前端的看家本领(饭碗), 基本上也是前端日常做得最多的事情
* 因此为了释放前端人力, 缓解人力短板, 让前端可以投入到更多更有挑战的地方去, 我们最应该将"搭页面的能力"服务化

## 如何将搭页面的能力服务化?

从技术发展的趋势上看, 服务化最终即平台化, 或者说是 [SaaS](https://baike.baidu.com/item/SaaS) 化, 一般会经历如下几个阶段
1. 一次封装(自己用), 例如封装一个函数, 在项目中使用, 避免重复开发
2. 一个公共库(别人也用), 例如封装一类函数, 形成一个公共包, 在多个项目中使用
3. 一套工具(自家人用), 例如封装一个生成短链接的工具, 可以在前端项目中使用(技术壁垒)
4. 一个平台(大家都用), 例如开发一个在线生成短链接的平台, 让所有人都可以使用(打破技术壁垒)

这个过程即服务的人群越来越多, 越来越广的过程, 还有就是更加通用化的过程

那么搭页面的能力如何服务化呢?
1. 封装   -> 组件化
2. 公共库 -> 组件库
3. 工具   -> 配置化
4. 平台   -> 在线化 -> 可视化

**即可以理解为要将前端搭页面的能力服务化, 最终的目标就是开发出一个可以拖拖拽拽就能够生成页面的平台, 也就是不需要写代码就可以上线页面的平台, 让大众都可以使用**

类似的平台例如[易企秀](https://www.eqxiu.com/), [Strikingly](https://www.strikingly.com "本土化产品“上线了”"), 大家可以去体验一下其中感受(仅为举例, 绝非广告)

## 如何循序渐进地达成服务化的目标?

结合最开始聊到的背景, 个人认为, 第一个小目标是实现可配置化的页面, 主要面对后台列表和表单类的页面, 因为
* 首先组件化配置化, **避免了重复开发**, 是提升前端本身的开发效率, 也就是降低前端的工作量, 让前端可以有更多的时间做更多的事(怎么有点压榨的感觉)
* 其次是通过配置化, 可以降低前端开发的难度, **减少对前端人员的依赖**
* 通过配置的方式, 理论上一个不太懂前端的人, 例如后端人员, 也可以完成部分前端的活了, 即又能充分发挥类似以前不分离时代的优势, 减少出现前端人员短板的情况
* 再例如一些简单的表单信息录入之类的页面, 后端如果自己可以配置出来, 就**不需要前端支持了**

这一步即达成通过配置的方式服务于开发人员, 让其可以通过配置, 以声明的方式, 快速搭建起一些列表或者表单之类的后台页面

即先是以任意的配置形式用起来, 再考虑通过额外的辅助工具(例如可视化平台)来优化这个过程, 让其运作得更好

具体关于配置化的实现方案, 请参考[配置化搭页面的技术选型](https://github.com/ufologist/new-page/blob/master/lib.md#%E9%85%8D%E7%BD%AE%E5%8C%96%E6%90%AD%E9%A1%B5%E9%9D%A2)

## 哪些页面可以配置出来?

可以毫不谦虚地说, 任何页面都可以"配置"出来. 当然了, 这背后主要是感谢 [百度 AMis](https://baidu.github.io/amis "前端低代码框架") 提供的配置化能力, 我们主要是应用这个能力, 快速服务于业务, 体现出技术的价值.

> 前端低代码框架，通过 JSON 配置就能生成各种后台页面。
> 
> 目前在百度大量用于内部平台的前端开发，已有 100+ 部门使用，创建了 1.2w+ 页面。

基于 AMis 的特点, 适合使用的场景有
* 各种 PC 端后台系统
* 列表(增删改查), 弹窗, 表单(**支持联动**)

## 运作原理

* 本仓库可以理解为是一个**根据页面配置信息来渲染页面的播放器**, 即 `page-schema-player`
* 类似于视频播放器, 读取视频文件, 例如 `video.mp4`, 然后播放(渲染)视频
* `page-schema-player` 是加载远程页面配置文件, 例如 `https://domain.com/page1.json`, 然后根据这个配置信息将页面渲染出来

## 如何配置出一个页面?

TODO


内置数据
* `_qsParams`: URL 参数, 可以在组件中拿到这个值, 例如 `${_qsParams._schema}`

## 如何扩展组件

TODO

```bash
npm start
```

## TODO

* 使用 standard-http-client 库, 并接入 nprogess
* 将 react react-dom axios qsman copy-to-clipboard standalone 都做为 extenal 配置
* JSON 编辑器报错
  使用的monaco-editor,用到了 worker, 如果控制台没有报错，说明一起正常。
  https://fex-team.github.io/amis-admin/admin/form/editor
* 缺少富文本编辑器, 需要找一个 react 的富文本编辑器, 例如百度的富文本编辑器试一试
* 添加 postcss autoprefix
* 优化其他 webpack 配置
* 做一个在线的编辑器, 通过 JSON schema 来写页面: "$schema": "https://houtai.baidu.com/v2/schemas/page.json"
或者指向本地文件, 这样更快一些?
* 做一个示例网站, 示例网站就用 schema 配置出来, 下拉列表选择通用的示例, 例如表单之类的, 然后出现 JSON 配置的内容和基于这个配置出来的页面